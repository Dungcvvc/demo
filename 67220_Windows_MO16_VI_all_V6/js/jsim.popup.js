/***js/jSim.Popup.js begin ***/
jSim.createNameSpace("Popup",function(pathPopup){this.model=new jSim.Popup.Model();this.view=new jSim.Popup.View(this.model,this);this.model.backButton=pathPopup.down('1').getObjectByNumber(pathPopup.down('1').getObjectCount()-1).getObjectByNumber(0);this.model.path=pathPopup});jSim.Popup.inheritsFrom(jSim.Abstract.Controller);jSim.Popup.createNameSpace("Model",function(){this.activateDelay=false;this.timerIDPopup=null;this.opened=false;this.backButton=null;this.path=null;this.isInitialized=false;this.source=null});jSim.Popup.Model.inheritsFrom(jSim.Abstract.Model);jSim.Popup.createNameSpace("View",function(model,controller){this.model=model;this.controller=controller});jSim.Popup.View.inheritsFrom(jSim.Abstract.View);jSim.Popup.extend({init:function(){this.addCodeMovie(this.model.path);this.specializedInit()},specializedInit:function(){},open:function(x,y,btn){try{if(!this.model.isInitialized){this.init();this.isInitialized=true}switch(arguments.length){case 0:this.setPosition(evt.clientX,evt.clientY);break;case 1:this.model.source=x;this.setPosition(evt.clientX,evt.clientY);break;case 2:if(!isNaN(x)&&!isNaN(y)){this.setPosition(x,y)}else{RTSetValue('/qco/logged','Open: Coordinate errate case 2');return}break;case 3:if(!isNaN(x)&&!isNaN(y)){this.setPosition(x,y);this.model.source=btn}else{RTSetValue('/qco/logged','Open: Coordinate errate case 3');return}break}this.model.path.goTo(this.model.path.getObjectByNumber(1).getName());this.model.opened=true;this.specializedOpen()}catch(e){Utils.printException(e,'Open')}},specializedOpen:function(){},normalizeBtnContainer:function(){if(typeof this.model.path.down('1').getObjectByNumber(0).addFrame==="undefined"){this.model.path.down('1').getObjectByNumber(0).setAllToFrame('normal')}else{this.model.path.down('1').getObjectByNumber(1).setAllToFrame('normal')}},setPosition:function(x,y){try{var xPup=x,yPup=y-78,newX,newY,btnCont,i,elFrm1,menuWidth,menuHeight,currentElement;if(this.model.path.getObjectCount()>=1){elFrm1=this.model.path.down('1').getObjectCount();btnCont=this.model.path.down('1').getObjectByNumber(elFrm1-2);menuWidth=btnCont.getWidth();menuHeight=btnCont.getHeight();if(parseInt(xPup,10)+parseInt(menuWidth,10)>800){newX=parseInt(xPup,10)-parseInt(menuWidth,10);if(newX<0){newX=0}}else{newX=xPup}if(parseInt(yPup,10)+parseInt(menuHeight,10)>600){newY=parseInt(yPup,10)-parseInt(menuHeight,10);if(newY<0){newY=0}}else{newY=yPup}btnCont.setPosition(newX,newY);for(i=0;i<elFrm1;i+=1){currentElement=this.model.path.down('1').getObjectByNumber(i);if(currentElement.getType()!=='movie'&&currentElement.getType()!=='textbox'){if(currentElement.getName()!=='b'){currentElement.setPosition(newX,newY)}}else{if(currentElement.getType()==='textbox'){currentElement.translate(newX,newY)}}}}}catch(e){Utils.printException(e,'setPosition')}},close:function(origine){try{var movieSup;origine=this.model.backButton;movieSup=origine.up().up().up();while(movieSup.getName()==='submenu'){movieSup=movieSup.up().up()}movieSup.down('1').getObjectByNumber(movieSup.down('1').getObjectCount()-2).setAllToFrame('normal');movieSup.goTo('0');this.model.opened=false;this.specializedClose()}catch(e){Utils.printException(e,'close')}},specializedClose:function(){},addCodeMovie:function(path){var i;for(i=0;i<path.getObjectCount();i+=1){this.addCodeFrame(path.getObjectByNumber(i))}},addCodeFrame:function(path){var i,contenitore;for(i=0;i<path.getObjectCount();i+=1){if(typeof path.getObjectByNumber(i).addFrame==="undefined"){contenitore=path.getObjectByNumber(i);if(contenitore.getName()!=='schermi'&&contenitore.getName()!=='schermo'){this.initCode(contenitore)}}else{this.addCodeMovie(path.getObjectByNumber(i))}}},initCode:function(btnCont){var popupName=$(this),backBtn=this.model.path.getObjectByNumber(1).getObjectByNumber(this.model.path.getObjectByNumber(1).getObjectCount()-1).getObjectByNumber(0),btnName,pathBtn,i,currentBtn,nameSubLev,pathBtnSub,lastBtn;try{for(i=0;i<btnCont.getObjectCount();i+=1){currentBtn=btnCont.getObjectByNumber(i);currentBtn.setAction('over',"$('"+popupName+"').openSublevel("+pathObj(btnCont.getObjectByNumber(i))+"); ");currentBtn.setAction('out',pathObj(currentBtn)+".goTo('normal'); ");btnName=currentBtn.getName();if(btnName.length>=3){switch(btnName.substr(0,3)){case'tnd':pathBtn=pathObj(btnCont.down("sel_"+btnName.substr(4,btnName.length-4)));currentBtn.setAction('click',"");currentBtn.addAction('over',pathBtn+".goTo('mouseover1');");currentBtn.setAction('down',pathBtn+".goTo('mousedown1');");currentBtn.setAction('out',pathBtn+".goTo('normal');");currentBtn.setAction('up',pathBtn+".goTo('normal');");break;case'cmb':pathBtn=pathObj(btnCont.down("pop_"+btnName.substr(4,btnName.length-4)));currentBtn.setAction('click',"");currentBtn.addAction('over',pathBtn+".goTo('mouseover1');");currentBtn.setAction('down',pathBtn+".goTo('mousedown1');");currentBtn.setAction('out',pathBtn+".goTo('normal');");currentBtn.setAction('up',pathBtn+".goTo('normal');");break;case'sel':pathBtn=pathObj(currentBtn);currentBtn.setAction('click',"");currentBtn.setAction('down',pathBtn+".goTo('mousedown');");currentBtn.addAction('over',pathBtn+".goTo('mouseover');");currentBtn.setAction('out',pathBtn+".goTo('normal');");currentBtn.setAction('up',pathBtn+".goTo('normal');");break;case'pop':pathBtn=pathObj(currentBtn);currentBtn.setAction('click',"api.addAction('uscita'); api.confirm();");currentBtn.setAction('down',pathBtn+".goTo('mousedown');");currentBtn.addAction('over',pathBtn+".goTo('mouseover');");currentBtn.setAction('out',pathBtn+".goTo('normal');");currentBtn.setAction('up',pathBtn+".goTo('normal');");break;case'dis':pathBtn=pathObj(currentBtn);currentBtn.setAction('click',"api.addAction('no_uscita');");currentBtn.addAction('over',pathBtn+".goTo('mouseover');");currentBtn.setAction('out',pathBtn+".goTo('normal');");break;case'sub':pathBtn=pathObj(currentBtn);nameSubLev=btnName.substr(4,btnName.length-4);pathBtnSub=pathObj(currentBtn.up().down(nameSubLev));currentBtn.setAction('click',"");currentBtn.setAction('down',"");currentBtn.setAction('over',"$('"+popupName+"').openSublevel("+pathBtnSub+"); "+pathBtn+".goTo('mouseover'); "+pathBtnSub+".goTo('mouseover');");currentBtn.setAction('up',"");break;default:currentBtn.setAction('click',"api.addAction('uscita_1'); api.confirm();")}}else{currentBtn.setAction('click',"api.addAction('uscita'); api.confirm();")}if(this.hasSubLevel(currentBtn,currentBtn.up().up())){currentBtn.setAction('out',"");if(currentBtn.getName().substr(0,3)==='btn'){currentBtn.setAction('click',"api.addAction('uscita'); api.confirm();")}else{currentBtn.setAction('click',"")}}lastBtn=btnCont.getObjectByNumber(btnCont.getObjectCount()-1);if(lastBtn.objectsV.length===0){lastBtn.setAction('click',"$('"+popupName+"').close();");lastBtn.setAction('down',"");lastBtn.setAction('over',"");lastBtn.setAction('out',"");lastBtn.setAction('up',"")}}backBtn.setAction('click',"$('"+popupName+"').close();");backBtn.setAction('over',"")}catch(e){Utils.printException(e,'initCode')}},hasSubLevel:function(btn,moviePopup){try{var nameSubLevel=btn.getName(),esito=false,j;if(moviePopup.getObjectByNumber(0).getName()==='submenu'){for(j=0;j<moviePopup.down('submenu').getObjectCount();j+=1){if(moviePopup.down('submenu').getObjectByNumber(j).getName()===nameSubLevel){esito=true}}}else{esito=false}return esito}catch(e){Utils.printException(e,'hasSubLevel')}},openAfter:function(delay,x,y){var name=$(this);try{this.model.activateDelay=true;if(x!=null&&y!=null){this.model.timerIDPopup=setTimeout(function(){$(name).open(x,y)},delay)}else{this.model.timerIDPopup=setTimeout(function(){$(name).open()},delay)}}catch(e){Utils.printException(e,'openAfter')}},abortOpen:function(){try{if(this.model.activateDelay){clearTimeout(this.model.timerIDPopup);this.model.activateDelay=false}}catch(e){Utils.printException(e,'abortOpen')}},openSublevel:function(btn){try{var frmSubLevel,ctnSubLevel,btnX,btnY,btnH,btnW,ctnSubLevelH,ctnSubLevelW,ctnSubLevelX,ctnSubLevelY;btnX=parseInt(btn.getTX(),10);btnY=parseInt(btn.getTY(),10)-78;btnH=parseInt(btn.getHeight(),10);btnW=parseInt(btn.getWidth(),10);frmSubLevel=btn.up().up().down(btn.up().up().getObjectByNumber(0).getName()).down(btn.getName());ctnSubLevel=frmSubLevel.down(frmSubLevel.getObjectByNumber(frmSubLevel.getObjectCount()-1).getName());ctnSubLevelH=parseInt(ctnSubLevel.getHeight(),10);ctnSubLevelW=parseInt(ctnSubLevel.getWidth(),10);if(btn.getCurrentFrame()==='normal'){btn.up().setAllToFrame('normal');btn.goTo('mouseover');ctnSubLevel.setAllToFrame('normal');btn.up().up().down(btn.up().up().getObjectByNumber(0).getName()).goTo(btn.getName())}if(btnX+btnW+ctnSubLevelW>800){ctnSubLevelX=btnX-ctnSubLevelW-1;if(ctnSubLevelX<0){ctnSubLevelX=0}}else{ctnSubLevelX=btnX+btnW}if(btnY+ctnSubLevelH>600){ctnSubLevelY=btnY+btnH-ctnSubLevelH;if(ctnSubLevelY<0){ctnSubLevelY=0}}else{ctnSubLevelY=btnY}ctnSubLevel.setPosition(ctnSubLevelX,ctnSubLevelY)}catch(e){try{btn.up().setAllToFrame('normal');btn.goTo('mouseover');btn.up().up().down('submenu').goTo('0')}catch(err){}}},getSource:function(){try{return this.model.source}catch(e){}},isVisible:function(){try{if(this.model.opened){return true}else{return false}}catch(e){Utils.printException(e,'isVisible')}}});
/***js/jSim.Popup.js end ***/
